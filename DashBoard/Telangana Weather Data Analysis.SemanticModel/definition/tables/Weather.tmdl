table Weather
	lineageTag: 45ebf484-c2ae-440c-9a74-259c710412f5

	measure 'Average Rainfall (mm)' = AVERAGE('Weather'[Rain (mm)])
		lineageTag: c2934298-49dc-4b75-a69b-d640d7d19043

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Total Rainfall (mm)' = SUM('Weather'[Rain (mm)])
		lineageTag: 03f8a8f7-2ab4-4426-ae6a-ed2763f1846d

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Days >100mm' =
			
			CALCULATE(
			    DISTINCTCOUNT(Weather[Date]),
			    Weather[Rain (mm)] > 100
			)
		formatString: 0
		lineageTag: 6ddad3f7-fc59-4b69-a01b-4efb94d41699

	measure 'Average Humidity (%)' = ```
			
			AVERAGEX(
			    'Weather',
			    ('Weather'[Max Humidity (%)] + 'Weather'[Min Humidity (%)]) / 2
			)
			
			```
		lineageTag: eeb528cc-a910-481b-b2b4-117f5e9b796c

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Avg Rainfall' = ```
			
			CALCULATE(
			    AVERAGE('Weather'[Rain (mm)]),
			    ALLEXCEPT('Weather', 'Weather'[District])
			)
			
			```
		lineageTag: b55123ef-5bd1-4ee5-a564-ae56267e7ec1

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Rainfall Anomaly (%)' =
			
			VAR CurrentRain = SUM('Weather'[Rain (mm)])
			VAR AvgRain = [Avg Rainfall]
			RETURN
			DIVIDE(CurrentRain - AvgRain, AvgRain) * 100
		lineageTag: bccc1d87-0c0b-4205-a8aa-a0ac6dc11b09

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Total Annual Rainfall' = ```
			
			CALCULATE(
			    SUM('Weather'[Rain (mm)]),
			    ALLEXCEPT('Weather', 'Weather'[Year], 'Weather'[District])
			)
			
			```
		lineageTag: 303a6ba8-a877-4f51-ae80-9ccdc76b49cd

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Monthly % of Annual Rainfall' = ```
			
			DIVIDE(
			    SUM('Weather'[Rain (mm)]),
			    [Total Annual Rainfall],
			    0
			) * 100
			
			```
		lineageTag: 670e1cab-0d50-42df-979b-9898d8373eb0

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Extreme Wind Count' =
			
			CALCULATE( COUNTROWS('Weather'), FILTER(ALLSELECTED('Weather'), [Extreme Wind Flag] <> "Normal") )
		lineageTag: 64a5e5c8-9b01-439d-bb1b-c887e99becae

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Avg Min Humidity (%)' = AVERAGE('Weather'[Min Humidity (%)])
		lineageTag: 8e5e5a86-b945-4ce1-8daf-f80f80a991e8

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Daily Humidity Range (%)' = ```
			
			AVERAGEX(
			    'Weather',
			    'Weather'[Max Humidity (%)] - 'Weather'[Min Humidity (%)]
			)
			
			```
		lineageTag: 03ea3d93-8d35-4d52-9cc1-a31074f66898

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'High Humidity Days' =
			
			VAR Thr = [Extreme Humidity Thr (%)]
			VAR T =
			    ADDCOLUMNS(
			        SUMMARIZE('Weather','Weather'[Date]),
			        "Humidity", CALCULATE( AVERAGEX('Weather', DIVIDE('Weather'[Max Humidity (%)] + 'Weather'[Min Humidity (%)], 2) ) )
			    )
			RETURN COUNTROWS( FILTER(T, [Humidity] >= Thr) )
		formatString: 0
		lineageTag: 60b5b0c9-cf3b-4756-9ef9-ed9c65c0d1bb

	measure 'Low Humidity Days' = ```
			
			CALCULATE(
			    COUNTROWS('Weather'),
			    FILTER('Weather', 'Weather'[Min Humidity (%)] <= 30)
			)
			
			```
		formatString: 0
		lineageTag: 22436646-970d-4891-9854-1246e9a05e73

	measure 'Extreme Humidity Days' =
			
			[High Humidity Days] + [Low Humidity Days]
		formatString: 0
		lineageTag: 0c7d97ce-4e4c-4b49-8e8f-01155daa10d6

	measure 'Avg Min Wind (Kmph)' = AVERAGE('Weather'[Min Wind Speed (Kmph)])
		lineageTag: 88e6bb6f-92ce-4de9-bf9b-f7ff50f44e28

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Avg Max Wind (Kmph)' = AVERAGE('Weather'[Max Wind Speed (Kmph)])
		lineageTag: f4961b08-97cf-483f-ae61-46ab621de8a5

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Avg Wind Speed (Kmph)' = ```
			
			AVERAGEX(
			    'Weather',
			    ('Weather'[Min Wind Speed (Kmph)] + 'Weather'[Max Wind Speed (Kmph)]) / 2
			)
			
			```
		lineageTag: 4b41ca0a-6abc-4b93-8615-f38aab9ab468

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Maximum Humidity (%)' = ```
			
			MAXX(ALLSELECTED('Weather'),
			     DIVIDE('Weather'[Max Humidity (%)] + 'Weather'[Min Humidity (%)], 2))
			
			```
		lineageTag: 146ba0c6-891e-46de-9773-b14b53dc00bc

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Minimum Humidity (%)' = ```
			
			MINX(ALLSELECTED('Weather'),
			     DIVIDE('Weather'[Max Humidity (%)] + 'Weather'[Min Humidity (%)], 2))
			
			```
		lineageTag: 9821fb78-53ab-483b-a769-334a53651d22

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Row Avg Humidity %' =
			
			AVERAGEX (
			    'Weather',
			    DIVIDE ( 'Weather'[Max Humidity (%)] + 'Weather'[Min Humidity (%)] , 2 )
			)
		lineageTag: 7431637a-1547-498f-957c-bedd869d81fd

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Humidity Anomaly' = ```
			
			VAR MeanHum = [Average Humidity (%)]
			VAR StdHum = STDEVX.P('Weather', [Average Humidity (%)])
			RETURN DIVIDE([Average Humidity (%)] - MeanHum, StdHum)
			
			```
		lineageTag: a7daebcd-089e-4607-ad5f-8998f556cf83

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Mean Humidity' =
			
			AVERAGEX (
			    ALLSELECTED('Weather'),
			    DIVIDE('Weather'[Max Humidity (%)] + 'Weather'[Min Humidity (%)], 2)
			)
		lineageTag: 51c8b3fd-260f-4f77-9385-bca57bf66182

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'SD Humidity' =
			
			STDEVX.P (
			    ALLSELECTED('Weather'),
			    DIVIDE('Weather'[Max Humidity (%)] + 'Weather'[Min Humidity (%)], 2)
			)
		lineageTag: eaae61bf-9dca-4f08-b95a-7d5da42f6edb

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Humidity Z-Score' =
			
			VAR MeanHum = CALCULATE(
			    AVERAGEX('Weather', ('Weather'[Max Humidity (%)] + 'Weather'[Min Humidity (%)]) / 2),
			    ALL('Weather')
			)
			VAR StdHum = CALCULATE(
			    STDEVX.P('Weather', ('Weather'[Max Humidity (%)] + 'Weather'[Min Humidity (%)] ) / 2),
			    ALL('Weather')
			)
			VAR CurHum = AVERAGEX('Weather', ('Weather'[Max Humidity (%)] + 'Weather'[Min Humidity (%)] ) / 2)
			RETURN
			DIVIDE(CurHum - MeanHum, StdHum)
		lineageTag: 87eb7a4b-9508-4411-8c8d-77bb46c55b0d

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Anomaly Flag' = ```
			
			VAR ZRain = [Rainfall Z-Score]
			VAR ZTemp = [Temperature Z-Score]
			VAR ZHum  = [Humidity Z-Score]
			VAR ZWind = [Wind Speed Z-Score]
			RETURN
			SWITCH(
			    TRUE(),
			    ABS(ZRain) > 2, "ðŸŒ§ Extreme Rainfall",
			    ABS(ZTemp) > 2, "ðŸ”¥ Extreme Temperature",
			    ABS(ZHum)  > 2, "ðŸ’§ Humidity Outlier",
			    ABS(ZWind) > 2, "ðŸ’¨ Wind Spike",
			    "âœ… Normal"
			)
			
			```
		lineageTag: 4ad502fb-57c1-4f9f-b8ec-6b2f609a0230

	measure 'VAR AvgHum' = ```
			DIVIDE('Weather'[Maximum Humidity (%)] + 'Weather'[Minimum Humidity (%)], 2)
			
			```
		lineageTag: ddabf10a-3d74-40f4-9a05-5b03f03a6eb4

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'VAR MeanHum' = ```
			CALCULATE([Mean Humidity], ALLSELECTED('Weather'))
			
			```
		lineageTag: a533b4a6-1ad7-4984-9f8d-28138eca2ffa

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Avg Rainfall (mm)' = AVERAGE('Weather'[Rain (mm)])
		lineageTag: 1e584ef6-da1d-498b-ba6b-fb54bc5c279e

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Bottom District (by Avg Rain)' =
			
			VAR T = SUMMARIZE(ALLSELECTED('Weather'), 'Weather'[District], "AvgRain", [Avg Rainfall (mm)])
			RETURN MAXX(TOPN(1, T, [AvgRain], ASC, 'Weather'[District], ASC), 'Weather'[District])
		lineageTag: 224595f5-edf2-4276-b951-69b4d6e6ffc6

	measure 'Top District (by Avg Rain)' = ```
			
			VAR T =
			    SUMMARIZE (
			        ALLSELECTED ( 'Weather' ),
			        'Weather'[District],
			        "TotalRain", [Total Rainfall (mm)]
			    )
			VAR TopRow =
			    TOPN ( 1, T, [TotalRain], DESC, 'Weather'[District], ASC )   -- tie-breaker
			RETURN
			CONCATENATEX ( TopRow, 'Weather'[District], "" )
			
			```
		lineageTag: 8c306d54-f67c-4c9b-8754-78700433f230

	measure 'Rainfall Z-Score' =
			
			VAR MeanRain = CALCULATE(AVERAGE('Weather'[Rain (mm)]), ALL('Weather'))
			VAR StdRain  = CALCULATE(STDEV.P('Weather'[Rain (mm)]), ALL('Weather'))
			RETURN
			DIVIDE(AVERAGE('Weather'[Rain (mm)]) - MeanRain, StdRain)
		lineageTag: 51c127ed-baad-454b-aa63-f405bddee940

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Monthly Rain %' = ```
			
			DIVIDE(
			    SUM('Weather'[Rain (mm)]),
			    CALCULATE(SUM('Weather'[Rain (mm)]), ALLEXCEPT('Weather', 'Weather'[Year], 'Weather'[District]))
			) * 100
			
			```
		lineageTag: 3fc9926d-296b-459e-b20d-9ebc753ee012

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Rainfall Intensity Index' = ```
			
			VAR AvgRain = CALCULATE(AVERAGE('Weather'[Rain (mm)]), ALLSELECTED('Weather'))
			VAR MaxRain = CALCULATE(MAX('Weather'[Rain (mm)]), ALLSELECTED('Weather'))
			RETURN
			DIVIDE([Total Rainfall (mm)], AvgRain, 0)
			
			```
		lineageTag: bc232e41-efa0-497f-a8bf-83181291020e

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Avg Min Temp (Â°C)' = AVERAGE('Weather'[Min Temp (Â°C)])
		lineageTag: 49487062-c3f6-4c7b-a7a2-69cddf229820

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Avg Max Temp (Â°C)' = ```
			AVERAGE('Weather'[Max Temp (Â°C)])
			
			```
		lineageTag: e09ebec8-6c8b-4433-8cbe-2fc620fdb8aa

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Avg Daily Range (Â°C)' = ```
			
			VAR PerDayRanges =
			    SUMMARIZE(
			        'Weather',
			        'Weather'[Date],                     -- daily grain
			        "Range",
			            MAX('Weather'[Max Temp (Â°C)])   -- max of that day within current filters
			          - MIN('Weather'[Min Temp (Â°C)])   -- min of that day within current filters
			    )
			RETURN
			    AVERAGEX(PerDayRanges, [Range])
			
			```
		lineageTag: 35a65d9a-a635-46fb-b11c-f935518541ea

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Temp Z-Score' = ```
			
			VAR MeanTemp = CALCULATE(AVERAGE('Weather'[Max Temp (Â°C)]), ALLSELECTED('Weather'))
			VAR StdTemp  = CALCULATE(STDEVX.P(ALLSELECTED('Weather'), 'Weather'[Max Temp (Â°C)]))
			VAR CurTemp  = AVERAGE('Weather'[Max Temp (Â°C)])
			RETURN DIVIDE(CurTemp - MeanTemp, StdTemp)
			
			```
		lineageTag: a3075b8c-d9d4-4e64-a114-334bbe5c188c

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Avg Daily Range (Â°C) Measure' = ```
			AVERAGEX(ALLSELECTED('Weather'), 'Weather'[Max Temp (Â°C)] - 'Weather'[Min Temp (Â°C)])
			
			```
		lineageTag: ef234d93-c0b1-45e6-be97-58233a7ac317

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Avg Temperature (Â°C)' =
			
			DIVIDE([Avg Max Temp (Â°C)] + [Avg Min Temp (Â°C)], 2)
		lineageTag: f9ec5864-724c-4778-a3bb-109b350dbaa1

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Extreme Temp Category' = ```
			
			VAR Z = [Temp Z-Score]
			RETURN
			SWITCH(
			    TRUE(),
			    Z >= 2, "ðŸ”¥ Extreme Heat",
			    Z <= -2, "â„ï¸ Extreme Cold",
			    "Normal"
			)
			
			```
		lineageTag: e277cfce-605f-41fb-acf2-f3c496b3ba96

	measure 'Temperature Correlation' =
			
			VAR T =
			    SUMMARIZE (
			        VALUES ( 'Weather'[District] ),      -- group by district (respects slicers like Year/Season)
			        'Weather'[District],
			        "X", [Avg Min Temp (Â°C)],
			        "Y", [Avg Max Temp (Â°C)]
			    )
			VAR N      = COUNTROWS ( T )
			VAR MeanX  = AVERAGEX ( T, [X] )
			VAR MeanY  = AVERAGEX ( T, [Y] )
			VAR CovXY  = SUMX ( T, ( [X] - MeanX ) * ( [Y] - MeanY ) )
			VAR VarXx   = SUMX ( T, ( [X] - MeanX ) ^ 2 )
			VAR VarY   = SUMX ( T, ( [Y] - MeanY ) ^ 2 )
			RETURN
			    DIVIDE( CovXY, SQRT( VarXx * VarY ) )
		lineageTag: fa5f6cb1-3356-4ee5-96fd-71c57fd6d2ea

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Avg Daily Humidity Range (%)' =
			
			VAR T = SUMMARIZE('Weather','Weather'[District],'Weather'[Date],
			        "R", MAX('Weather'[Max Humidity (%)]) - MIN('Weather'[Min Humidity (%)]) )
			RETURN AVERAGEX(T,[R])
		lineageTag: 1c96d5bd-69e6-44d3-8340-af2fc03a20b8

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Extreme Humidity Flag' = ```
			
			IF([Humidity Z] >= 2, "High Humidity",
			IF([Humidity Z] <= -2, "Low Humidity", "Normal"))
			
			```
		lineageTag: 3071ee09-c554-4119-ae86-fb4abd628077

	measure 'Max Humidity 3Y MA (%)' =
			
			VAR y = MAX('Weather'[Year])
			RETURN
			AVERAGEX(
			    FILTER(ALLSELECTED('Weather'),
			        'Weather'[Year] >= y - 1 && 'Weather'[Year] <= y + 1
			    ),
			    [Extreme Wind Count]
			)
		lineageTag: d4b6c7ea-4394-462e-a3cb-69855e72a163

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Min Humidity 3Y MA (%)' =
			
			VAR y = MAX('Weather'[Year])
			RETURN
			AVERAGEX(
			    FILTER(ALLSELECTED('Weather'),
			        'Weather'[Year] >= y - 1 && 'Weather'[Year] <= y + 1
			    ),
			    [Avg Min Humidity (%)]
			)
		lineageTag: e00db1b2-1768-4a9b-b891-b30d30a0bd72

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Avg Wind (Kmph)' = DIVIDE([Avg Max Wind (Kmph)] + [Avg Min Wind (Kmph)], 2)
		lineageTag: ab8c3c0d-454f-46dd-9557-688251384535

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Avg Daily Wind Range (Kmph)' =
			
			VAR T = SUMMARIZE('Weather','Weather'[District],'Weather'[Date],
			        "R", MAX('Weather'[Max Wind Speed (Kmph)]) - MIN('Weather'[Min Wind Speed (Kmph)]) )
			RETURN AVERAGEX(T,[R])
		lineageTag: 0b30608d-fe7c-4aea-b5dd-26d6cd7249c5

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Wind Z-Score' = ```
			
			VAR MeanW =
			    CALCULATE( AVERAGE('Weather'[Max Wind Speed (Kmph)]), ALLSELECTED('Weather') )
			VAR StdW  =
			    CALCULATE( STDEVX.P(ALLSELECTED('Weather'), 'Weather'[Max Wind Speed (Kmph)]) )
			VAR CurW  = AVERAGE('Weather'[Max Wind Speed (Kmph)])
			RETURN DIVIDE(CurW - MeanW, StdW)
			
			```
		lineageTag: 8f7c30bf-d520-4c42-8386-91d8e0662cdf

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Wind Outlier (IQR)' = ```
			
			VAR G = ALLEXCEPT('Weather', 'Weather'[District], 'Weather'[Year])
			VAR Q1 = PERCENTILEX.INC(G, 'Weather'[Max Wind Speed (Kmph)], 0.25)
			VAR Q3 = PERCENTILEX.INC(G, 'Weather'[Max Wind Speed (Kmph)], 0.75)
			VAR IQR = Q3 - Q1
			VAR x   = AVERAGE('Weather'[Max Wind Speed (Kmph)])
			RETURN
			SWITCH(TRUE(), x > Q3 + 1.5*IQR, "High (IQR)", x < Q1 - 1.5*IQR, "Low (IQR)", "Normal")
			
			```
		lineageTag: 17c7a889-0caa-43ab-877e-916458775475

	measure 'Min Wind Trend (Kmph)' = AVERAGE('Weather'[Min Wind Speed (Kmph)])
		lineageTag: 6ac88647-bca6-4c23-b5ae-44da8f60cd62

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Max Wind Trend (Kmph)' = ```
			AVERAGE('Weather'[Max Wind Speed (Kmph)])
			
			```
		lineageTag: 649ac5c8-e3df-4659-9d9f-a7783f744feb

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Extreme Wind Days' = ```
			
			CALCULATE(
			  COUNTROWS('Weather'),
			  FILTER(
			    'Weather',
			    [Wind Z-Score] >= 2 || [Wind Z-Score] <= -2
			  )
			)
			
			```
		formatString: 0
		lineageTag: ad2a8c41-6467-461a-8a56-47f71297e03d

	measure 'Extreme Wind Rate (%)' =
			
			DIVIDE([Extreme Wind Days], COUNTROWS('Weather')) * 100
		lineageTag: 50a2f534-31ae-417c-bd89-aae6485bb5d4

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Correlation Rainâ€“Temp' = ```
			
			VAR T =
			    FILTER(
			        ADDCOLUMNS(
			            VALUES('Weather'[District]),     -- change grain if needed (Year/Month)
			            "X", [Total Rain (mm)],
			            "Y", [Avg Temp (Â°C)]
			        ),
			        NOT ISBLANK([X]) && NOT ISBLANK([Y])
			    )
			VAR mx = AVERAGEX(T,[X])
			VAR my = AVERAGEX(T,[Y])
			VAR cov= SUMX(T, ([X]-mx)*([Y]-my))
			VAR vx = SUMX(T, ([X]-mx)*([X]-mx))
			VAR vy = SUMX(T, ([Y]-my)*([Y]-my))
			RETURN DIVIDE(cov, SQRT(vx*vy))
			
			```
		lineageTag: d64e8b91-0655-47ea-aef9-148359221bcf

	measure 'Total Rain (mm)' = SUM('Weather'[Rain (mm)])
		lineageTag: b6201e22-726b-48d4-9633-7d5f35148aa5

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Avg Rain (mm)' = AVERAGE('Weather'[Rain (mm)])
		lineageTag: b23c21d7-bcd5-407e-9c48-419ed4cbf6db

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Avg Temp (Â°C)' = DIVIDE([Avg Max Temp (Â°C)] + [Avg Min Temp (Â°C)], 2)
		lineageTag: 6c155aa6-84e7-43df-92cb-b9d4892fb08e

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Avg Daily Temp Range (Â°C)' =
			
			AVERAGEX('Weather', 'Weather'[Max Temp (Â°C)] - 'Weather'[Min Temp (Â°C)])
		lineageTag: 15b546e7-5c4c-45d6-b84e-f949a7ef15d0

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Rain Z' =
			
			VAR MeanRain = CALCULATE(AVERAGE('Weather'[Rain (mm)]), ALLSELECTED('Weather'))
			VAR StdRain  = CALCULATE(STDEVX.P(ALLSELECTED('Weather'), 'Weather'[Rain (mm)]))
			VAR X        = AVERAGE('Weather'[Rain (mm)])
			RETURN IF(StdRain=0, BLANK(), DIVIDE(X-MeanRain, StdRain))
		lineageTag: 3e851005-ff52-4991-85bd-622899cadca9

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Temp Z' =
			
			VAR MeanT = CALCULATE([Avg Temp (Â°C)], ALLSELECTED('Weather'))
			VAR StdT  = CALCULATE(STDEVX.P(ALLSELECTED('Weather'), [Avg Temp (Â°C)]))
			VAR X     = [Avg Temp (Â°C)]
			RETURN IF(StdT=0, BLANK(), DIVIDE(X-MeanT, StdT))
		lineageTag: 3d999bcb-0c32-4aac-8fa4-7113979b9d56

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Wind Z' =
			
			VAR MeanW = CALCULATE([Avg Wind (Kmph)], ALLSELECTED('Weather'))
			VAR StdW  = CALCULATE(STDEVX.P(ALLSELECTED('Weather'), [Avg Wind (Kmph)]))
			VAR X     = [Avg Wind (Kmph)]
			RETURN IF(StdW=0, BLANK(), DIVIDE(X-MeanW, StdW))
		lineageTag: f343baac-30cf-428d-9f38-b3688df96871

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Humidity Z' =
			
			VAR MeanH = CALCULATE([Average Humidity (%)], ALLSELECTED('Weather'))
			VAR StdH  = CALCULATE(STDEVX.P(ALLSELECTED('Weather'), [Average Humidity (%)]))
			VAR X     = [Average Humidity (%)]
			RETURN IF(StdH=0, BLANK(), DIVIDE(X-MeanH, StdH))
		lineageTag: ca46856c-d695-4556-b05d-1fc527d84725

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Overall Anomaly Z' = ```
			
			AVERAGEX(
			    {
			        ABS([Rain Z]),
			        ABS([Temp Z]),
			        ABS([Humidity Z]),
			        ABS([Wind Z])
			    },
			    [Value]
			)
			
			```
		lineageTag: 855ab111-3d16-4cc4-aba3-3f8746282fab

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Extreme Weather Flag' = ```
			
			VAR R = [Rain Z]
			VAR T = [Temp Z]
			VAR H = [Humidity Z]
			VAR W = [Wind Z]
			RETURN
			SWITCH(
			    TRUE(),
			    R >= 2 || T >= 2 || H >= 2 || W >= 2, "Extreme High",
			    R <= -2 || T <= -2 || H <= -2 || W <= -2, "Extreme Low",
			    "Normal"
			)
			
			```
		lineageTag: 95c04533-a674-4397-b3ce-c84cc6f246e8

	measure 'Temp 3Y MA (Â°C)' =
			
			VAR y = MAX('Weather'[Year])
			RETURN
			AVERAGEX(
			    FILTER(ALLSELECTED('Weather'), 'Weather'[Year] >= y-1 && 'Weather'[Year] <= y+1),
			    [Avg Temp (Â°C)]
			)
		lineageTag: eb84eeb6-f6e4-44a4-b645-cb2b1e7a8488

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Humidity 3Y MA (%)' =
			
			VAR y = MAX('Weather'[Year])
			RETURN
			AVERAGEX(
			    FILTER(ALLSELECTED('Weather'), 'Weather'[Year] >= y-1 && 'Weather'[Year] <= y+1),
			    [Average Humidity (%)]
			)
		lineageTag: 93ed2942-61da-4fb4-ad4c-fa8e3e21a11d

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Wind 3Y MA (Kmph)' =
			
			VAR y = MAX('Weather'[Year])
			RETURN
			AVERAGEX(
			    FILTER(ALLSELECTED('Weather'), 'Weather'[Year] >= y-1 && 'Weather'[Year] <= y+1),
			    [Avg Wind (Kmph)]
			)
		lineageTag: 18dd1e6e-1232-4c8e-a7bd-f04424be3896

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Avg Temp on Extreme Rain (Â°C)' = ```
			
			CALCULATE(
			    [Avg Temp (Â°C)],
			    FILTER(ALLSELECTED('Weather'), [Rain Z] >= 2)
			)
			
			```
		lineageTag: 2160b924-51b0-4279-a148-891085200d9e

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Rain 3Y MA (mm)' =
			
			VAR y = MAX('Weather'[Year])
			RETURN
			AVERAGEX(
			    FILTER(ALLSELECTED('Weather'), 'Weather'[Year] >= y-1 && 'Weather'[Year] <= y+1),
			    [Total Rain (mm)]
			)
		lineageTag: 7b57bdd4-df36-4bda-b903-b57567f01193

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Extreme Rain Flag' = ```
			
			IF([Rain Z] >= 2, "Extreme Rain",
			IF([Rain Z] <= -2, "Low Rain", "Normal"))
			
			```
		lineageTag: 069ef696-a485-4fc1-8de4-a2024192551f

	measure 'Extreme Temp Flag' = ```
			
			IF([Temp Z] >= 2, "Heatwave",
			IF([Temp Z] <= -2, "Cold Spell", "Normal"))
			
			```
		lineageTag: 39daa607-7110-46b8-8596-7209027866c2

	measure 'Monthly Rainfall (mm)' = ```
			
			CALCULATE(
			    SUM ( 'Weather'[Rain (mm)] ),
			    ALLEXCEPT ( 'Weather', 'Weather'[Year], 'Weather'[Month Name] )
			)
			
			```
		lineageTag: 41c11435-0e17-41a2-9b93-fd72a2697177

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Monthly Rainfall % of Year' = ```
			
			VAR Num = SUM ( 'Weather'[Rain (mm)] )
			VAR Den =
			    CALCULATE (
			        SUM ( 'Weather'[Rain (mm)] ),
			        REMOVEFILTERS ('Weather'[Month Name] )
			    )
			RETURN
			IF ( HASONEVALUE ( 'Weather'[Month Name] ), DIVIDE ( Num, Den ), BLANK() )
			
			```
		lineageTag: 7657e890-2bd3-4061-a8d4-de8b40438390

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Monthly Avg Temp (Â°C)' =
			
			CALCULATE(
			    AVERAGEX (
			        VALUES ( 'Weather'[Date] ),
			        ( 'Weather'[Avg Max Temp (Â°C)] + 'Weather'[Avg Min Temp (Â°C)]) / 2
			    ),
			    ALLEXCEPT ( 'Weather', 'Weather'[Year], 'Weather'[Month Name] )
			)
		lineageTag: 150d4521-5004-4495-828a-ed16ee4b0480

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Monthly Temp Range (Â°C)' =
			
			CALCULATE(
			    AVERAGEX (
			        VALUES ( 'Weather'[Date] ),
			        'Weather'[Avg Max Temp (Â°C)] - 'Weather'[Avg Min Temp (Â°C)]
			    ))
		lineageTag: 9a814695-5e51-401f-b7bd-a6a8192e03ea

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Monthly Temp MoM (Â°C)' = ```
			
			VAR Curr = [Monthly Avg Temp (Â°C)]
			VAR Prev =
			    CALCULATE(
			        [Monthly Avg Temp (Â°C)],
			        DATEADD ( 'Weather'[Date], -1, MONTH )
			    )
			RETURN Curr - Prev
			
			```
		lineageTag: ac34b52d-41e8-4d05-81c1-969eb521c397

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Monthly Temp YoY (Â°C)' = ```
			
			VAR Curr = [Monthly Avg Temp (Â°C)]
			VAR PrevYear =
			    CALCULATE(
			        [Monthly Avg Temp (Â°C)],
			        SAMEPERIODLASTYEAR ( 'Weather'[Date] )
			    )
			RETURN Curr - PrevYear
			
			```
		lineageTag: 9b418c41-07ab-49bc-960f-9185684a7d88

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Monthly Avg Humidity (%)' = ```
			
			CALCULATE(
			    AVERAGEX (
			        VALUES ( 'Weather'[Date] ),
			        ( 'Weather'[Extreme Wind Count] + 'Weather'[Avg Min Humidity (%)] ) / 2
			    ),
			    ALLEXCEPT ( 'Weather', 'Weather'[Year], 'Weather'[Month Name] )
			)
			
			```
		lineageTag: f84d70d8-a566-41fa-a5c7-b67abcd5e602

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Monthly Humidity Range (%)' = ```
			
			CALCULATE(
			    AVERAGEX (
			        VALUES ( 'Weather'[Date] ),
			        'Weather'[Extreme Wind Count] - 'Weather'[Avg Min Humidity (%)]
			    ),
			    ALLEXCEPT ( 'Weather', 'Weather'[Year], 'Weather'[Month Name] )
			)
			
			```
		lineageTag: a07054f1-22b7-4f5f-a003-ee9b55255332

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Bottom Rainfall District Name' =
			
			CALCULATE(
			    SELECTEDVALUE('Weather'[District]),
			    TOPN(1, SUMMARIZE('Weather', 'Weather'[District], "TotalRain", SUM('Weather'[Rain (mm)])), [TotalRain], ASC)
			)
		lineageTag: 85c1acea-29f0-4bbf-9906-818e12adf919

	measure 'Max Monthly Rainfall (mm)' = ```
			
			VAR MonthlyRain =
			    ADDCOLUMNS (
			        SUMMARIZE (
			            'Weather',
			            'Weather'[District],
			            'Weather'[Month Name]
			        ),
			        "Total", SUM('Weather'[Rain (mm)])
			    )
			RETURN
			    MAXX(MonthlyRain, [Total])
			
			```
		lineageTag: 7ffc30fa-f45d-4dca-8da9-f19fa4752a35

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Heavy Rain Days Count' =
			
			COUNTROWS(FILTER('Weather', 'Weather'[Rain (mm)] > 100))
		formatString: 0
		lineageTag: 39a1c619-448b-40c1-a8cc-606100ae6f7e

	measure 'Rainfall YoY Change' =
			
			VAR CurrentYear = MAX('Weather'[Year])
			VAR PrevYear = CurrentYear - 1
			VAR CurrentRain = CALCULATE(SUM('Weather'[Rain (mm)]), 'Weather'[Year] = CurrentYear)
			VAR PrevRain = CALCULATE(SUM('Weather'[Rain (mm)]), 'Weather'[Year] = PrevYear)
			RETURN
			DIVIDE(CurrentRain - PrevRain, PrevRain, 0)
		lineageTag: be820fab-ebc1-42c4-a422-1a3af3316ef2

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Hottest District Name' =
			
			CALCULATE(
			    SELECTEDVALUE('Weather'[District]),
			    TOPN(1, SUMMARIZE('Weather', 'Weather'[District], "AvgMax", AVERAGE('Weather'[Max Temp (Â°C)])), [AvgMax], DESC)
			)
		lineageTag: b8f3e93d-cacb-4224-9099-efe3c7d51c21

	measure 'Coldest District Name' =
			
			CALCULATE(
			    SELECTEDVALUE('Weather'[District]),
			    TOPN(1, SUMMARIZE('Weather', 'Weather'[District], "AvgMin", AVERAGE('Weather'[Min Temp (Â°C)])), [AvgMin], ASC)
			)
		lineageTag: abbdf2c3-a5dc-4934-a13b-63a696a9d88d

	measure 'Heatwave Days Count' =
			
			COUNTROWS(FILTER('Weather', 'Weather'[Max Temp (Â°C)] > 40))
		formatString: 0
		lineageTag: f9fef5d4-d884-4064-bbf7-15ee7b0c4b80

	measure 'Temp YoY Change' =
			
			VAR CurrentYear = MAX('Weather'[Year])
			VAR PrevYear = CurrentYear - 1
			VAR CurrentTemp = CALCULATE(AVERAGE('Weather'[Max Temp (Â°C)]), 'Weather'[Year] = CurrentYear)
			VAR PrevTemp = CALCULATE(AVERAGE('Weather'[Max Temp (Â°C)]), 'Weather'[Year] = PrevYear)
			RETURN
			DIVIDE(CurrentTemp - PrevTemp, PrevTemp, 0)
		lineageTag: 1ad6a2ab-911b-43a8-9b93-4e63a6f6c40a

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Max Humidity (%) Measure' =
			
			MAX ( 'Weather'[Max Humidity (%)] )
		lineageTag: a39e55ea-2982-47f0-9978-8d9304f20647

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Top Humidity District Name' =
			
			VAR T =
			    ADDCOLUMNS(
			        SUMMARIZE( ALLSELECTED('Weather'), 'Weather'[District] ),
			        "AvgHum", CALCULATE( [Average Humidity (%)] )
			    )
			RETURN
			CONCATENATEX( TOPN(1, T, [AvgHum], DESC), 'Weather'[District], ", " )
		lineageTag: 6ed83ac4-bdc2-47b1-b5d4-e01ffae9addf

	measure 'Bottom Humidity District Name' =
			
			VAR T =
			    ADDCOLUMNS(
			        SUMMARIZE( ALLSELECTED('Weather'), 'Weather'[District] ),
			        "AvgHum", CALCULATE( [Average Humidity (%)] )
			    )
			RETURN
			CONCATENATEX( TOPN(1, T, [AvgHum], ASC), 'Weather'[District], ", " )
		lineageTag: 0124db5d-95a9-4937-8d5b-5b788b43df49

	measure 'Extreme Humidity Days Count' =
			
			COUNTROWS(
			    FILTER(
			        'Weather',
			        'Weather'[Max Humidity (%)] >= 90
			    )
			)
		formatString: 0
		lineageTag: b947b2cf-545e-44d5-b75a-94923b3d49f7

	measure 'Humidity YoY Change' =
			
			VAR CurY  = MAX('Weather'[Year])
			VAR PrevY = CurY - 1
			VAR CurV  = CALCULATE( [Average Humidity (%)], 'Weather'[Year] = CurY )
			VAR PrevV = CALCULATE( [Average Humidity (%)], 'Weather'[Year] = PrevY )
			RETURN DIVIDE( CurV - PrevV, PrevV, 0 )
		lineageTag: be779602-3e29-4fc1-94e7-c85e380c4249

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Top Wind District Name' = ```
			
			VAR T =
			    ADDCOLUMNS(
			        SUMMARIZE( ALLSELECTED('Weather'), 'Weather'[District] ),
			        "AvgWind", CALCULATE( [Avg Wind Speed (Kmph)] )
			    )
			RETURN
			CONCATENATEX( TOPN(1, T, [AvgWind], DESC), 'Weather'[District], ", " )
			
			```
		lineageTag: 29b80ced-178c-435e-b5bb-152810fa6d94

	measure 'Bottom Wind District Name' =
			
			VAR T =
			    ADDCOLUMNS(
			        SUMMARIZE( ALLSELECTED('Weather'), 'Weather'[District] ),
			        "AvgWind", CALCULATE( [Avg Wind Speed (Kmph)] )
			    )
			RETURN
			CONCATENATEX( TOPN(1, T, [AvgWind], ASC), 'Weather'[District], ", " )
		lineageTag: a33075f5-ef38-4d9c-b3e8-054294061efd

	measure 'High Wind Days Count' =
			
			COUNTROWS(
			    FILTER(
			        'Weather',
			        'Weather'[Max Wind Speed (Kmph)] >= 40
			    )
			)
		formatString: 0
		lineageTag: 8a950d96-a97b-4e82-8917-bbfa8ed5f0c0

	measure 'Wind YoY Change' =
			
			VAR CurY  = MAX('Weather'[Year])
			VAR PrevY = CurY - 1
			VAR CurV  = CALCULATE( [Avg Wind Speed (Kmph)], 'Weather'[Year] = CurY )
			VAR PrevV = CALCULATE( [Avg Wind Speed (Kmph)], 'Weather'[Year] = PrevY )
			RETURN DIVIDE( CurV - PrevV, PrevV, 0 )
		lineageTag: fd67a0bc-a6fe-462d-b0be-0943dc5c62d9

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Corr Rain vs Temp' = ```
			
			VAR T =
			    FILTER(
			        ADDCOLUMNS(
			            VALUES('Weather'[District]),          
			            "X", [Total Rainfall (mm)],
			            "Y", [Avg Temp (Â°C)]
			        ),
			        NOT ISBLANK([X]) && NOT ISBLANK([Y])
			    )
			VAR MeanX = AVERAGEX(T, [X])
			VAR MeanY = AVERAGEX(T, [Y])
			VAR CovXY = SUMX(T, ([X]-MeanX)*([Y]-MeanY))
			VAR VarXx  = SUMX(T, POWER([X]-MeanX, 2))
			VAR VarY  = SUMX(T, POWER([Y]-MeanY, 2))
			RETURN DIVIDE(CovXY, SQRT(VarXx*VarY))
			
			```
		lineageTag: 1ec98a61-e52e-458f-833a-ed05388064ce

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Corr Rain vs Humidity' = ```
			
			VAR T =
			    FILTER(
			        ADDCOLUMNS(
			            VALUES('Weather'[District]),          
			            "X", [Total Rainfall (mm)],
			            "Y", [Average Humidity (%)]
			        ),
			        NOT ISBLANK([X]) && NOT ISBLANK([Y])
			    )
			VAR MeanX = AVERAGEX(T, [X])
			VAR MeanY = AVERAGEX(T, [Y])
			VAR CovXY = SUMX(T, ([X]-MeanX)*([Y]-MeanY))
			VAR VarXx  = SUMX(T, POWER([X]-MeanX, 2))
			VAR VarY  = SUMX(T, POWER([Y]-MeanY, 2))
			RETURN DIVIDE(CovXY, SQRT(VarXx*VarY))
			
			```
		lineageTag: cbf2e45b-a860-4678-8d46-e817181598d4

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Corr Rain vs Wind' = ```
			
			VAR T =
			    FILTER(
			        ADDCOLUMNS(
			            VALUES('Weather'[District]),          
			            "X", [Total Rainfall (mm)],
			            "Y", [Avg Wind (Kmph)]
			        ),
			        NOT ISBLANK([X]) && NOT ISBLANK([Y])
			    )
			VAR MeanX = AVERAGEX(T, [X])
			VAR MeanY = AVERAGEX(T, [Y])
			VAR CovXY = SUMX(T, ([X]-MeanX)*([Y]-MeanY))
			VAR VarXx  = SUMX(T, POWER([X]-MeanX, 2))
			VAR VarY  = SUMX(T, POWER([Y]-MeanY, 2))
			RETURN DIVIDE(CovXY, SQRT(VarXx*VarY))
			
			```
		lineageTag: 36042d4e-3ae7-4426-828c-5fd9f6f61bd5

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Yearly Rainfall (mm)' =
			
			CALCULATE(
			    SUM('Weather'[Rain (mm)]),
			    ALLEXCEPT('Weather', 'Weather'[Year])
			)
		lineageTag: 2c38137b-aabc-47c4-8882-dbdd1ccef7f1

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Yearly Avg Temp (Â°C)' =
			
			CALCULATE(
			    AVERAGEX(VALUES('Weather'[Date]),
			        ('Weather'[Avg Max Temp (Â°C)] + 'Weather'[Avg Min Temp (Â°C)]) / 2
			    ),
			    ALLEXCEPT('Weather', 'Weather'[Year])
			)
		lineageTag: 765a32f8-e690-4610-9378-27872e63d67c

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Yearly Avg Humidity (%)' =
			
			CALCULATE(
			    AVERAGEX(VALUES('Weather'[Date]),
			        ('Weather'[Maximum Humidity (%)] + 'Weather'[Minimum Humidity (%)]) / 2
			    ),
			    ALLEXCEPT('Weather', 'Weather'[Year])
			)
		lineageTag: 0785c419-9ddd-4be6-9cc8-25dba749be65

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Yearly Avg Wind (Kmph)' =
			
			CALCULATE(
			    AVERAGEX(VALUES('Weather'[Date]),
			        ('Weather'[Avg Max Wind (Kmph)] + 'Weather'[Avg Min Wind (Kmph)]) / 2
			    ),
			    ALLEXCEPT('Weather', 'Weather'[Year])
			)
		lineageTag: 271a1c1e-2ea0-42d8-808e-6d80932e16ef

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure Measure
		lineageTag: 3046220c-fdc3-4f03-b2dd-5103d8f02c07

		annotation 43dbc3e8-3a1c-4b6f-9923-b49ff7d6691c = True

	measure 'Seasonal Rainfall (mm)' =
			
			SUM('Weather'[Rain (mm)])
		lineageTag: f39d90aa-490f-4d42-8a9f-bb19d82c798c

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Seasonal Avg Temp (Â°C)' =
			
			AVERAGEX(
			    'Weather',
			    DIVIDE('Weather'[Max Temp (Â°C)] + 'Weather'[Min Temp (Â°C)], 2)
			)
		lineageTag: 8c301cfd-633a-4ef5-bf96-7a24ad4ad4ad

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Seasonal Temp Range (Â°C)' =
			
			AVERAGEX(
			    'Weather',
			    'Weather'[Max Temp (Â°C)] - 'Weather'[Min Temp (Â°C)]
			)
		lineageTag: ecb98bd0-c51b-43c2-bb13-810ed7cab9c7

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Seasonal Avg Humidity (%)' =
			
			AVERAGEX(
			    'Weather',
			    DIVIDE('Weather'[Max Humidity (%)] + 'Weather'[Min Humidity (%)], 2)
			)
		lineageTag: 57d1de5d-b941-47ae-9e5c-76ef2e42bd39

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Seasonal Humidity Range (%)' =
			
			AVERAGEX(
			    'Weather',
			    'Weather'[Max Humidity (%)] - 'Weather'[Min Humidity (%)]
			)
		lineageTag: 6375eb27-9ef2-4bff-9ad9-458d639f7f4a

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Seasonal Avg Wind Speed (Kmph)' =
			
			AVERAGEX(
			    'Weather',
			    DIVIDE('Weather'[Max Wind Speed (Kmph)] + 'Weather'[Min Wind Speed (Kmph)], 2)
			)
		lineageTag: 46d820c7-9b77-4e79-a17a-3a643f822842

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Seasonal Wind Range (Kmph)' =
			
			AVERAGEX(
			    'Weather',
			    'Weather'[Max Wind Speed (Kmph)] - 'Weather'[Min Wind Speed (Kmph)]
			)
		lineageTag: 7fbcdf81-a62b-4f4d-8bbb-48c50a4e3630

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Measure 2'
		lineageTag: 3b7219c7-64df-451d-8390-f6145d503631

		annotation 43dbc3e8-3a1c-4b6f-9923-b49ff7d6691c = True

	measure 'Temperature Z-Score' =
			
			VAR MeanTemp = CALCULATE(
			    AVERAGEX('Weather', ('Weather'[Max Temp (Â°C)] + 'Weather'[Min Temp (Â°C)]) / 2),
			    ALL('Weather')
			)
			VAR StdTemp = CALCULATE(
			    STDEVX.P('Weather', ('Weather'[Max Temp (Â°C)] + 'Weather'[Min Temp (Â°C)]) / 2),
			    ALL('Weather')
			)
			VAR CurTemp = AVERAGEX('Weather', ('Weather'[Max Temp (Â°C)] + 'Weather'[Min Temp (Â°C)]) / 2)
			RETURN
			DIVIDE(CurTemp - MeanTemp, StdTemp)
		lineageTag: 2ba2d0bd-dd69-4f9b-9a8a-d593e1fdba91

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Wind Speed Z-Score' =
			
			VAR MeanWind = CALCULATE(
			    AVERAGEX('Weather', ('Weather'[Max Wind Speed (Kmph)] + 'Weather'[Min Wind Speed (Kmph)]) / 2),
			    ALL('Weather')
			)
			VAR StdWind = CALCULATE(
			    STDEVX.P('Weather', ('Weather'[Max Wind Speed (Kmph)] + 'Weather'[Min Wind Speed (Kmph)]) / 2),
			    ALL('Weather')
			)
			VAR CurWind = AVERAGEX('Weather', ('Weather'[Max Wind Speed (Kmph)] + 'Weather'[Min Wind Speed (Kmph)]) / 2)
			RETURN
			DIVIDE(CurWind - MeanWind, StdWind)
		lineageTag: f67e6a14-74a2-460d-9a21-f2eac3ee4971

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Measure 3'
		lineageTag: d294b720-d864-4d03-a127-7e93b15159b7

		annotation 43dbc3e8-3a1c-4b6f-9923-b49ff7d6691c = True

	measure 'Selected Metric Value' = ```
			
			SWITCH(
			    SELECTEDVALUE('Metric Selector'[Metric]),
			    "Rainfall", [Total Rainfall (mm)],
			    "Temperature", [Avg Temperature (Â°C)],
			    "Humidity", [Average Humidity (%)],
			    "Wind Speed", [Avg Wind Speed (Kmph)]
			)
			
			```
		lineageTag: cb7edcf5-5790-4c33-9843-9ae3135b0b34

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Relationship Insight' =
			
			"Rainâ€“Temp Corr: " & FORMAT([Corr Rain vs Temp], "0.00")
			& " | Rainâ€“Humidity Corr: " & FORMAT([Corr Rain vs Humidity], "0.00")
			& " | Rainâ€“Wind Corr: " & FORMAT([Corr Rain vs Wind], "0.00")
		lineageTag: 0c58866e-0b54-4919-8349-ed790de25059

	measure 'Extreme Wind Flag' =
			
			SWITCH(TRUE(),
			    [Wind Z] >=  2, "High Wind",
			    [Wind Z] <= -2, "Low Wind",
			    "Normal"
			)
		lineageTag: 15e17ce6-266b-48ee-9862-a03601b62db4

	measure 'Extreme Humidity Count' = ```
			
			CALCULATE( COUNTROWS('Weather'), FILTER(ALLSELECTED('Weather'), [Extreme Humidity Flag] <> "Normal") )
			
			```
		formatString: 0
		lineageTag: e4403e20-49ec-4775-861f-8662c266f694

	measure 'Extreme Temp Count' =
			
			CALCULATE( COUNTROWS('Weather'), FILTER(ALLSELECTED('Weather'), [Extreme Temp Flag] <> "Normal") )
		formatString: 0
		lineageTag: 41559f4a-36d1-4eaa-ba49-b4801da9365c

	measure 'Extreme Rain Count' =
			
			CALCULATE( COUNTROWS('Weather'), FILTER(ALLSELECTED('Weather'), [Extreme Rain Flag] <> "Normal") )
		formatString: 0
		lineageTag: 844cbb46-6c53-47f3-aef6-9d17b79ecba1

	measure 'Seasonal Avg Rainfall' =
			
			AVERAGE('Weather'[Rain (mm)])
		lineageTag: f4437998-c0c8-46f9-8aca-75005c07db8a

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Rainfall YoY %' =
			
			VAR CurY  = MAX('Weather'[Year])
			VAR PrevY = CurY - 1
			VAR Cur   = CALCULATE(SUM('Weather'[Rain (mm)]), 'Weather'[Year] = CurY)
			VAR Prev  = CALCULATE(SUM('Weather'[Rain (mm)]), 'Weather'[Year] = PrevY)
			RETURN DIVIDE(Cur - Prev, Prev, 0)
		lineageTag: 37b0629b-b813-4f91-9e29-cc459326e4c7

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Temperature YoY Î” (Â°C)' =
			
			VAR CurY  = MAX('Weather'[Year])
			VAR PrevY = CurY - 1
			VAR Cur   = CALCULATE([Avg Temperature (Â°C)], 'Weather'[Year] = CurY)
			VAR Prev  = CALCULATE([Avg Temperature (Â°C)], 'Weather'[Year] = PrevY)
			RETURN Cur - Prev
		lineageTag: db416b7c-8395-4e2b-873d-83aff487661a

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Humidity YoY Î” (%)' =
			
			VAR CurY  = MAX('Weather'[Year])
			VAR PrevY = CurY - 1
			VAR Cur   = CALCULATE([Average Humidity (%)], 'Weather'[Year] = CurY)
			VAR Prev  = CALCULATE([Average Humidity (%)], 'Weather'[Year] = PrevY)
			RETURN Cur - Prev
		lineageTag: 7765a0b2-c1bb-4278-8130-e2bc83257b34

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Wind YoY Î” (Kmph)' =
			
			VAR CurY  = MAX('Weather'[Year])
			VAR PrevY = CurY - 1
			VAR Cur   = CALCULATE([Avg Wind Speed (Kmph)], 'Weather'[Year] = CurY)
			VAR Prev  = CALCULATE([Avg Wind Speed (Kmph)], 'Weather'[Year] = PrevY)
			RETURN Cur - Prev
		lineageTag: 167a91f3-3235-45ff-bcea-4ba8aa088042

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Seasonal Share of Annual Rain (%)' =
			
			VAR RainSeason =
			    CALCULATE(SUM('Weather'[Rain (mm)]), ALLSELECTED('Weather'))
			VAR RainYear =
			    CALCULATE(SUM('Weather'[Rain (mm)]),
			              REMOVEFILTERS('Weather'[Season]))
			RETURN DIVIDE(RainSeason, RainYear, 0) * 100
		lineageTag: d58e7fd5-e12e-4cd7-94e5-9b22ce9624bd

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Daily Rain Range (mm)' = ```
			
			VAR DailyRain =
			    ADDCOLUMNS(
			        SUMMARIZE('Weather', 'Weather'[Date]),
			        "DailyTotal", CALCULATE(SUM('Weather'[Rain (mm)]))
			    )
			RETURN MAXX(DailyRain, [DailyTotal]) - MINX(DailyRain, [DailyTotal])
			
			```
		lineageTag: 19da1c02-f50f-4bca-b64e-2a26fdbfc5bd

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Extreme Rain Days' =
			
			VAR Thr = [Extreme Rain Thr (mm)]
			VAR T =
			    ADDCOLUMNS(
			        SUMMARIZE('Weather','Weather'[Date]),
			        "Rain", CALCULATE(SUM('Weather'[Rain (mm)]))
			    )
			RETURN COUNTROWS( FILTER(T, [Rain] >= Thr) )
		formatString: 0
		lineageTag: e896ad46-ee2c-4cae-980a-4fdd3de5a410

	measure 'Extreme Rain Thr (mm)' =
			
			VAR T =
			    ADDCOLUMNS(
			        SUMMARIZE('Weather','Weather'[Date]),
			        "Rain", CALCULATE(SUM('Weather'[Rain (mm)]))
			    )
			RETURN PERCENTILEX.INC( T, [Rain], 0.95 )
		lineageTag: e263975f-bb29-43d9-93fc-76f7620b2b3d

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Extreme Temp Thr (Â°C)' =
			
			VAR T =
			    ADDCOLUMNS(
			        SUMMARIZE('Weather','Weather'[Date]),
			        "Temp", CALCULATE( AVERAGEX('Weather', DIVIDE('Weather'[Max Temp (Â°C)] + 'Weather'[Min Temp (Â°C)], 2) ) )
			    )
			RETURN PERCENTILEX.INC( T, [Temp], 0.95 )
		lineageTag: cb406bdc-81fc-4e12-baba-c16f4717b8a6

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Extreme Humidity Thr (%)' =
			
			VAR T =
			    ADDCOLUMNS(
			        SUMMARIZE('Weather','Weather'[Date]),
			        "Humidity", CALCULATE( AVERAGEX('Weather', DIVIDE('Weather'[Max Humidity (%)] + 'Weather'[Min Humidity (%)], 2) ) )
			    )
			RETURN PERCENTILEX.INC( T, [Humidity], 0.95 )
		lineageTag: 4c82a3fc-8f44-4b88-a14a-8cf9bb6d206b

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Extreme Wind Thr (Kmph)' =
			
			VAR T =
			    ADDCOLUMNS(
			        SUMMARIZE('Weather','Weather'[Date]),
			        "Wind", CALCULATE( AVERAGEX('Weather', DIVIDE('Weather'[Max Wind Speed (Kmph)] + 'Weather'[Min Wind Speed (Kmph)], 2) ) )
			    )
			RETURN PERCENTILEX.INC( T, [Wind], 0.95 )
		lineageTag: fe9a62a0-b784-4edb-81cf-c08ea59f23fb

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Measure 4'
		lineageTag: 532324f3-249b-411c-97fa-71cebc357ed8

		annotation 43dbc3e8-3a1c-4b6f-9923-b49ff7d6691c = True

	measure 'Heatwave Days' =
			
			VAR Thr = [Extreme Temp Thr (Â°C)]
			VAR T =
			    ADDCOLUMNS(
			        SUMMARIZE('Weather','Weather'[Date]),
			        "Temp", CALCULATE( AVERAGEX('Weather', DIVIDE('Weather'[Max Temp (Â°C)] + 'Weather'[Min Temp (Â°C)], 2) ) )
			    )
			RETURN COUNTROWS( FILTER(T, [Temp] >= Thr) )
		formatString: 0
		lineageTag: 21f60784-f80e-43d6-86ab-76f493e04b9f

	measure 'Measure 5'
		lineageTag: 9e65f412-804b-4aff-9277-43195ed2cc03

		annotation 43dbc3e8-3a1c-4b6f-9923-b49ff7d6691c = True

	measure 'Measure 6'
		lineageTag: 99a41de1-0fb2-4f27-9355-013fbf03a148

		annotation 43dbc3e8-3a1c-4b6f-9923-b49ff7d6691c = True

	measure 'High Wind Days' =
			
			VAR Thr = [Extreme Wind Thr (Kmph)]
			VAR T =
			    ADDCOLUMNS(
			        SUMMARIZE('Weather','Weather'[Date]),
			        "Wind", CALCULATE( AVERAGEX('Weather', DIVIDE('Weather'[Max Wind Speed (Kmph)] + 'Weather'[Min Wind Speed (Kmph)], 2) ) )
			    )
			RETURN COUNTROWS( FILTER(T, [Wind] >= Thr) )
		formatString: 0
		lineageTag: a00ba603-5a4b-4830-98ff-0ad7ef56ab03

	measure 'Extreme Days (Any)' =
			
			VAR RainThr = [Extreme Rain Thr (mm)]
			VAR TempThr = [Extreme Temp Thr (Â°C)]
			VAR HumThr  = [Extreme Humidity Thr (%)]
			VAR WindThr = [Extreme Wind Thr (Kmph)]
			VAR T =
			    ADDCOLUMNS(
			        SUMMARIZE('Weather','Weather'[Date]),
			        "Rain",     CALCULATE(SUM('Weather'[Rain (mm)])),
			        "Temp",     CALCULATE( AVERAGEX('Weather', DIVIDE('Weather'[Max Temp (Â°C)] + 'Weather'[Min Temp (Â°C)], 2) ) ),
			        "Humidity", CALCULATE( AVERAGEX('Weather', DIVIDE('Weather'[Max Humidity (%)] + 'Weather'[Min Humidity (%)], 2) ) ),
			        "Wind",     CALCULATE( AVERAGEX('Weather', DIVIDE('Weather'[Max Wind Speed (Kmph)] + 'Weather'[Min Wind Speed (Kmph)], 2) ) )
			    )
			RETURN
			COUNTROWS(
			    FILTER(T, [Rain] >= RainThr || [Temp] >= TempThr || [Humidity] >= HumThr || [Wind] >= WindThr)
			)
		formatString: 0
		lineageTag: 126b3f1f-5612-4dcc-8147-133bc5c594c0

	measure 'Most Affected District (Extreme Days)' = ```
			
			VAR TDist =
			    ADDCOLUMNS(
			        SUMMARIZE( ALLSELECTED('Weather'), 'Weather'[District] ),
			        "ExtremeDays", CALCULATE( [Extreme Days (Any)] )
			    )
			RETURN CONCATENATEX( TOPN(1, TDist, [ExtremeDays], DESC), 'Weather'[District], ", " )
			
			```
		lineageTag: 34024e2d-e244-4158-aec3-c4be38873d4f

	measure 'Î” Temp when Extreme Rain (Â°C)' =
			
			VAR Thr =
			    [Extreme Rain Thr (mm)]
			VAR T =
			    ADDCOLUMNS(
			        SUMMARIZE('Weather','Weather'[Date]),
			        "Rain", CALCULATE(SUM('Weather'[Rain (mm)])),
			        "Temp", CALCULATE( AVERAGEX('Weather', DIVIDE('Weather'[Max Temp (Â°C)] + 'Weather'[Min Temp (Â°C)], 2) ) )
			    )
			VAR ExtremeT = FILTER(T, [Rain] >= Thr)
			VAR NormalT  = FILTER(T, [Rain] <  Thr)
			RETURN AVERAGEX(ExtremeT, [Temp]) - AVERAGEX(NormalT, [Temp])
		lineageTag: 6f51207f-3e18-47b8-b708-98094e46a1f0

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Î” Humidity when Extreme Rain (%)' = ```
			
			VAR Thr =
			    [Extreme Rain Thr (mm)]
			VAR T =
			    ADDCOLUMNS(
			        SUMMARIZE('Weather','Weather'[Date]),
			        "Rain",     CALCULATE(SUM('Weather'[Rain (mm)])),
			        "Humidity", CALCULATE( AVERAGEX('Weather', DIVIDE('Weather'[Max Humidity (%)] + 'Weather'[Min Humidity (%)], 2) ) )
			    )
			VAR ExtremeT = FILTER(T, [Rain] >= Thr)
			VAR NormalT  = FILTER(T, [Rain] <  Thr)
			RETURN AVERAGEX(ExtremeT, [Humidity]) - AVERAGEX(NormalT, [Humidity])
			
			```
		lineageTag: c94d23ff-6a74-491a-9d3b-81269da17c69

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	measure 'Î” Wind when Extreme Rain (Kmph)' =
			
			VAR Thr =
			    [Extreme Rain Thr (mm)]
			VAR T =
			    ADDCOLUMNS(
			        SUMMARIZE('Weather','Weather'[Date]),
			        "Rain", CALCULATE(SUM('Weather'[Rain (mm)])),
			        "Wind", CALCULATE( AVERAGEX('Weather', DIVIDE('Weather'[Max Wind Speed (Kmph)] + 'Weather'[Min Wind Speed (Kmph)], 2) ) )
			    )
			VAR ExtremeT = FILTER(T, [Rain] >= Thr)
			VAR NormalT  = FILTER(T, [Rain] <  Thr)
			RETURN AVERAGEX(ExtremeT, [Wind]) - AVERAGEX(NormalT, [Wind])
		lineageTag: 5f638bcc-0464-41e9-be26-6a55355a3f19

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column 'Source.Name'
		dataType: string
		lineageTag: 0f73ecc3-95fb-4222-96c6-3b4d7754423d
		summarizeBy: none
		sourceColumn: Source.Name

		annotation SummarizationSetBy = Automatic

	column District
		dataType: string
		lineageTag: df0ac050-cab2-4262-9c72-588453ca1e3b
		summarizeBy: none
		sourceColumn: District

		annotation SummarizationSetBy = Automatic

	column Mandal
		dataType: string
		lineageTag: 9c0cf7e6-b3b9-4306-93c1-41682c3b84bb
		summarizeBy: none
		sourceColumn: Mandal

		annotation SummarizationSetBy = Automatic

	column Date
		dataType: dateTime
		formatString: Long Date
		lineageTag: ef0d9ca1-d9bc-4624-beff-1d030053178b
		summarizeBy: none
		sourceColumn: Date

		variation Variation
			isDefault
			relationship: c5251d74-415d-4fe8-9226-de70716df5ce
			defaultHierarchy: LocalDateTable_e41233db-0544-4777-b7e5-ae50dfaee3f2.'Date Hierarchy'

		annotation SummarizationSetBy = Automatic

		annotation UnderlyingDateTimeDataType = Date

	column 'Rain (mm)'
		dataType: double
		lineageTag: a0512980-a452-4e93-a576-d96b28aa37d0
		summarizeBy: sum
		sourceColumn: Rain (mm)

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column 'Min Temp (Â°C)'
		dataType: double
		lineageTag: 59cf4c63-5203-4f05-96df-d2294f2fe617
		summarizeBy: sum
		sourceColumn: Min Temp (Â°C)

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column 'Max Temp (Â°C)'
		dataType: double
		lineageTag: 7c8fa088-5f82-46fa-83be-9c72e99153d1
		summarizeBy: sum
		sourceColumn: Max Temp (Â°C)

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column 'Min Humidity (%)'
		dataType: double
		lineageTag: f4a88316-466f-445e-b51c-ef588ce1bb4b
		summarizeBy: sum
		sourceColumn: Min Humidity (%)

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column 'Max Humidity (%)'
		dataType: double
		lineageTag: 77164a81-6377-455b-85c0-e445a292b827
		summarizeBy: sum
		sourceColumn: Max Humidity (%)

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column 'Min Wind Speed (Kmph)'
		dataType: double
		lineageTag: f7114915-73b3-4ee0-8fac-f77d0920bc7f
		summarizeBy: sum
		sourceColumn: Min Wind Speed (Kmph)

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column 'Max Wind Speed (Kmph)'
		dataType: double
		lineageTag: 9e0df395-401d-476b-be6c-92005ad36dc4
		summarizeBy: sum
		sourceColumn: Max Wind Speed (Kmph)

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column 'Month Name' = FORMAT(Weather[Date], "MMMM")
		lineageTag: fa764aad-52a4-49f9-8133-89ab58eb6207
		summarizeBy: none

		annotation SummarizationSetBy = Automatic

	column 'Month Number' = MONTH(Weather[Date])
		formatString: 0
		lineageTag: 8fa599f4-5921-43fd-82e8-f245d33d14e6
		summarizeBy: sum

		changedProperty = SortByColumn

		annotation SummarizationSetBy = Automatic

	column Year = YEAR(Weather[Date])
		formatString: 0
		lineageTag: 8261896c-e4ad-417c-80cc-870bfc906b1c
		summarizeBy: sum

		changedProperty = SortByColumn

		annotation SummarizationSetBy = Automatic

	column Season = ```
			
			SWITCH(
			    TRUE(),
			    MONTH(Weather[Date]) IN {12,1,2}, "Winter",
			    MONTH(Weather[Date]) IN {3,4,5}, "Summer",
			    MONTH(Weather[Date]) IN {6,7,8,9}, "Monsoon",
			    MONTH(Weather[Date]) IN {10,11}, "Post-Monsoon",
			    "Unknown"
			)
			
			```
		lineageTag: 42bc1e91-0d63-435b-857a-91942fc75cea
		summarizeBy: none

		annotation SummarizationSetBy = Automatic

	column 'Month-Year Label' = FORMAT(Weather[Date], "MMM yyyy")
		lineageTag: 62f250b4-367f-430e-9321-0c1814b9aabe
		summarizeBy: none

		changedProperty = SortByColumn

		annotation SummarizationSetBy = Automatic

	column 'Humidity Range (Row)' =
			
			'Weather'[Max Humidity (%)] - 'Weather'[Min Humidity (%)]
		lineageTag: 994cb271-1f5b-4e4a-ae53-2deed2761d8b
		summarizeBy: sum

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column 'Rainfall Category' = ```
			
			SWITCH(
			    TRUE(),
			    'Weather'[Rain (mm)] > 100, "Heavy Rain",
			    'Weather'[Rain (mm)] > 50, "Moderate Rain",
			    'Weather'[Rain (mm)] > 20, "Light Rain",
			    "No Rain"
			)
			
			```
		lineageTag: b7e3e8c6-5ee0-47f0-9fe9-6eb37b3668a1
		summarizeBy: none

		annotation SummarizationSetBy = Automatic

	column 'Wind Outlier Flag' =
			
			SWITCH(TRUE(),
			    [Wind Z-Score] >=  2, "Very High",
			    [Wind Z-Score] <= -2, "Very Low",
			    "Normal"
			)
		lineageTag: 087d19d9-1edc-4c67-8bc6-ad958d2c012f
		summarizeBy: none

		annotation SummarizationSetBy = Automatic

	column Yeared
		dataType: int64
		formatString: 0
		lineageTag: de48550e-f083-4c2d-9378-b04b9bd2de36
		summarizeBy: sum
		sourceColumn: Yeared

		annotation SummarizationSetBy = Automatic

	partition Weather = m
		mode: import
		source =
				let
				    Source = Folder.Files("C:\Users\Hope\Downloads\TS Weather Data"),
				    #"Filtered Hidden Files1" = Table.SelectRows(Source, each [Attributes]?[Hidden]? <> true),
				    #"Invoke Custom Function1" = Table.AddColumn(#"Filtered Hidden Files1", "Transform File", each #"Transform File"([Content])),
				    #"Renamed Columns1" = Table.RenameColumns(#"Invoke Custom Function1", {"Name", "Source.Name"}),
				    #"Removed Other Columns1" = Table.SelectColumns(#"Renamed Columns1", {"Source.Name", "Transform File"}),
				    #"Expanded Table Column1" = Table.ExpandTableColumn(#"Removed Other Columns1", "Transform File", Table.ColumnNames(#"Transform File"(#"Sample File"))),
				    #"Changed Type" = Table.TransformColumnTypes(#"Expanded Table Column1",{{"Source.Name", type text}, {"District", type text}, {"Mandal", type text}, {"Date", type date}, {"Rain (mm)", type number}, {"Min Temp (Â°C)", type number}, {"Max Temp (Â°C)", type number}, {"Min Humidity (%)", type number}, {"Max Humidity (%)", type number}, {"Min Wind Speed (Kmph)", type number}, {"Max Wind Speed (Kmph)", type number}}),
				    #"Filtered Rows" = Table.SelectRows(#"Changed Type", each ([Mandal] <> "14" and [Mandal] <> "15" and [Mandal] <> "17" and [Mandal] <> "18" and [Mandal] <> "19" and [Mandal] <> "20" and [Mandal] <> "21" and [Mandal] <> "23" and [Mandal] <> "24" and [Mandal] <> "25" and [Mandal] <> "26" and [Mandal] <> "27" and [Mandal] <> "28" and [Mandal] <> "30" and [Mandal] <> "31" and [Mandal] <> "32" and [Mandal] <> "33")),
				    #"Inserted Year" = Table.AddColumn(#"Filtered Rows", "Year", each Date.Year([Date]), Int64.Type),
				    #"Renamed Columns" = Table.RenameColumns(#"Inserted Year",{{"Year", "Yeared"}}),
				    #"Filtered Rows1" = Table.SelectRows(#"Renamed Columns", each ([District] <> "Warangal Rural" and [District] <> "Warangal Urban")),
				    #"Replaced Value" = Table.ReplaceValue(#"Filtered Rows1","Hanumakkonda","Hanumakonda",Replacer.ReplaceText,{"District"}),
				    #"Replaced Value1" = Table.ReplaceValue(#"Replaced Value","Anumula_Haliya","Anumula Haliya",Replacer.ReplaceText,{"Mandal"}),
				    #"Replaced Value2" = Table.ReplaceValue(#"Replaced Value1","Atmakur_M","Atmakur (M)",Replacer.ReplaceText,{"Mandal"}),
				    #"Replaced Value3" = Table.ReplaceValue(#"Replaced Value2","Atmakur_S ","Atmakur (S) ",Replacer.ReplaceText,{"Mandal"}),
				    #"Replaced Value4" = Table.ReplaceValue(#"Replaced Value3","Chinna_Chintha_Kunta","Chinna Chinta Kunta",Replacer.ReplaceText,{"Mandal"}),
				    #"Replaced Value5" = Table.ReplaceValue(#"Replaced Value4","Yeda_Palle","Yeda Palle",Replacer.ReplaceText,{"Mandal"}),
				    #"Replaced Value6" = Table.ReplaceValue(#"Replaced Value5","Dundigal_Gandimaisamma","Dundigal Gandimaisamma",Replacer.ReplaceText,{"Mandal"}),
				    #"Replaced Value7" = Table.ReplaceValue(#"Replaced Value6","Ghanapur_Mulug","Ghanapur Mulug",Replacer.ReplaceText,{"Mandal"}),
				    #"Replaced Value8" = Table.ReplaceValue(#"Replaced Value7","Ganpur_Stn","Ganpur Stn",Replacer.ReplaceText,{"Mandal"}),
				    #"Replaced Value9" = Table.ReplaceValue(#"Replaced Value8","Atmakur_S","Atmakur (S)",Replacer.ReplaceText,{"Mandal"}),
				    #"Replaced Value10" = Table.ReplaceValue(#"Replaced Value9","Jagityal_Rural","Jagityal Rural",Replacer.ReplaceText,{"Mandal"}),
				    #"Replaced Value11" = Table.ReplaceValue(#"Replaced Value10","Kaloor_Timmanadoddi","Kaloor Timmanadoddi",Replacer.ReplaceText,{"Mandal"}),
				    #"Replaced Value12" = Table.ReplaceValue(#"Replaced Value11","Karimnagar_Rural","Karimnagar Rural",Replacer.ReplaceText,{"Mandal"}),
				    #"Replaced Value13" = Table.ReplaceValue(#"Replaced Value12","Khammam_Rural","Khammam Rural",Replacer.ReplaceText,{"Mandal"}),
				    #"Replaced Value14" = Table.ReplaceValue(#"Replaced Value13","Khammam_Urban","Khammam Urban",Replacer.ReplaceText,{"Mandal"}),
				    #"Replaced Value15" = Table.ReplaceValue(#"Replaced Value14","Khilla_Warangal","Khilla Warangal",Replacer.ReplaceText,{"Mandal"}),
				    #"Replaced Value16" = Table.ReplaceValue(#"Replaced Value15","Mahabubnagar_Rural","Mahabubnagar Rural",Replacer.ReplaceText,{"Mandal"}),
				    #"Replaced Value17" = Table.ReplaceValue(#"Replaced Value16","Mahabubnagar_Urban","Mahabubnagar Urban",Replacer.ReplaceText,{"Mandal"}),
				    #"Replaced Value18" = Table.ReplaceValue(#"Replaced Value17","Hanumakkonda","Hanumakonda",Replacer.ReplaceText,{"Mandal"})
				in
				    #"Replaced Value18"

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

